---
title: 'useEffect'
subTitle: 'useEffect ê³µë¶€í•´ë³´ê¸° (ìŠ¤í„°ë”” ë°œí‘œ ìë£Œ)'
date: '2023-10-26'
tag: 'React'
url: 'react-2'
thumbnail: './imgs/2/1.png'
thumbnail_alt: 'useEffect ê³µì‹ ë¬¸ì„œ ìº¡ì³ í™”ë©´'
---

## ì™œ ì‚¬ìš©í• ê¹Œ?

side effectë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´.
side effectëŠ” ì§ì ‘ì ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ í•¨ìˆ˜ ì•ˆì— ë“¤ì–´ê°€ë©´ ì•ˆ ëœë‹¤. ë²„ê·¸ë‚˜ ë¬´í•œ ë£¨í”„ê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸.

```jsx
const App = () => {
  const [state, setState] = useState('');

  fetch('https://api.quotable.io/random')
    .then((response) => response.json())
    .then((data) => {
      if (data.content) {
        setState(data.content);
      }
    });

  return <div>{state}</div>;
};

export default App;
```

ë”°ë¼ì„œ ì´ë¥¼ ë°©ì§€í•˜ê³ ì side effectë¥¼ ì²˜ë¦¬í•˜ëŠ” ë„êµ¬ê°€ í•„ìš”. â‡’ `useEffect` í›….

# ì‚¬ìš©ë²•

```jsx
useEffect(setup, dependencies?);
```

ë‘ ê°œì˜ argumentì™€ ê°™ì´ í˜¸ì¶œëœë‹¤.

- `setup`: `Effect`ì˜ ë¡œì§ì„ í¬í•¨í•˜ëŠ” í•¨ìˆ˜. componentê°€ `DOM`ì— ì¶”ê°€ë  ë•Œ, ReactëŠ” `setup` í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
- (optional) `dependencies`: **`setup`** ì½”ë“œ ë‚´ë¶€ì—ì„œ ì°¸ì¡°ëœ ëª¨ë“  **reactive values**ì˜ ëª©ë¡.
  **reactive values**ì—ëŠ” **props**, **state**, ê·¸ë¦¬ê³  ì»´í¬ë„ŒíŠ¸ ë³¸ë¬¸ ë‚´ì—ì„œ ì§ì ‘ ì„ ì–¸ëœ ëª¨ë“  **ë³€ìˆ˜**ì™€ **í•¨ìˆ˜**ê°€ í¬í•¨ëœë‹¤.
  ì´ `dependencies`ì˜ ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ `setup` í•¨ìˆ˜ê°€ ë‹¤ì‹œ ì‹¤í–‰ëœë‹¤.
- `useEffect` í•¨ìˆ˜ëŠ” `undefined`ë¥¼ ë°˜í™˜í•œë‹¤.

# ì‹¤í–‰ë˜ëŠ” ê²½ìš°

## ì¢…ì†ì„± ì—†ëŠ” ê²½ìš°

```jsx
useEffect(() => {
  console.log('EFFECT RUNNING');
});
```

- ì²˜ìŒ ë§ˆìš´íŠ¸ ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ëœë‹¤.
- stateê°€ ì—…ë°ì´íŠ¸ ë˜ì–´ ì¬ë Œë”ë§ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.

## ë¹ˆ ì¢…ì†ì„± ë°°ì—´ì„ ê°–ëŠ” ê²½ìš°

```jsx
useEffect(() => {
  console.log('EFFECT RUNNING');
}, []);
```

- ì²˜ìŒ ë§ˆìš´íŠ¸ë˜ê³  ë Œë”ë§ë  ë•Œë§Œ ì‹¤í–‰ëœë‹¤.

## ì¢…ì†ì„±ì´ ì¶”ê°€ëœ ê²½ìš°

```jsx
useEffect(() => {
  console.log('EFFECT RUNNING');
}, [enteredPassword]);
```

- ì²˜ìŒ ë§ˆìš´íŠ¸ ë˜ì—ˆì„ ë•Œ ì‹¤í–‰ëœë‹¤.
- ì˜ì¡´ì„±ì— ì¶”ê°€ëœ stateê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.

## clean up í•¨ìˆ˜

```jsx
useEffect(() => {
  console.log('EFFECT RUNNING');

  return () => {
    console.log('CLEAN UP');
  };
}, [enteredPassword]);
```

- ì²« ë Œë”ë§ì—ëŠ” ì‹¤í–‰ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.
- ì˜ì¡´ì„±ì— ì¶”ê°€ëœ stateê°€ ë³€ê²½ë  ë•Œ, ê°€ì¥ ë¨¼ì € ì‹¤í–‰ì´ ëœë‹¤.
- ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ ë  ë•Œ ì‹¤í–‰ëœë‹¤.

## ì •ë¦¬

1. `setup` codeëŠ” ì»´í¬ë„ŒíŠ¸ê°€ í˜ì´ì§€ì— ì¶”ê°€ë  ë•Œ(ë§ˆìš´íŠ¸ë  ë•Œ) ì‹¤í–‰ëœë‹¤.
2. ì»´í¬ë„ŒíŠ¸ê°€ ì¬ë Œë”ë§ë˜ê³  ì¢…ì†ì„±(`dependencies`)ì´ ë³€ê²½ëœ ê²½ìš°:
   1. ë¨¼ì € ì´ì „ì˜ propsì™€ stateë¥¼ ì‚¬ìš©í•˜ì—¬ `cleanup` codeê°€ ì‹¤í–‰ëœë‹¤.
   2. ê·¸ëŸ° ë‹¤ìŒ ìƒˆë¡œìš´ propsì™€ stateë¥¼ ì‚¬ìš©í•˜ì—¬ `setup` codeê°€ ì‹¤í–‰ëœë‹¤.
3. ì»´í¬ë„ŒíŠ¸ê°€ í˜ì´ì§€ì—ì„œ ì œê±°ë  ë•Œ(ì–¸ë§ˆìš´íŠ¸ë  ë•Œ), `cleanup` codeê°€ í•œ ë²ˆ ë” ì‹¤í–‰ëœë‹¤.

> ğŸ’¡ ë²„ê·¸ë¥¼ ì°¾ì•„ë‚´ëŠ” ë° ë„ì›€ì„ ì£¼ê¸° ìœ„í•œ ê°œë°œ ëª¨ë“œ(Strict mode)ì—ì„œ
> ReactëŠ” `setup`ê³¼ `cleanup`ì„ `setup` ì „ì— í•œ ë²ˆ ë” ì‹¤í–‰í•œë‹¤.
>
> ì´ëŠ” Effectì˜ ë¡œì§ì´ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ë‹¤.
> ì´ë¡œ ì¸í•´ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš°, `cleanup` í•¨ìˆ˜ì— ì¼ë¶€ ë¡œì§ì´ ëˆ„ë½ë˜ì–´ ìˆëŠ” ê²ƒì¼ ìˆ˜ ìˆë‹¤.
>
> `cleanup` í•¨ìˆ˜ëŠ” `setup` í•¨ìˆ˜ê°€ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì„ ì¤‘ì§€í•˜ê±°ë‚˜ ë˜ëŒë ¤ì•¼ í•˜ê¸°ì—,
> ì¼ë°˜ì ì¸ ì›ì¹™ì€ ì‚¬ìš©ìê°€ `setup` í•¨ìˆ˜ê°€ í•œ ë²ˆ í˜¸ì¶œë˜ëŠ” ê²ƒ(productìš©)ê³¼
> `setup` â†’ `cleanup` â†’ `setup` ì‹œí€€ìŠ¤(developìš©)ë¥¼ êµ¬ë¶„í•  ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
>
> ë‹¤ì‹œ ë§í•´, ìì£¼ `setup` ë° `cleanup`ì„ ì‹¤í–‰í•´ë„ EffectëŠ” ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•´ì•¼ í•œë‹¤.

# ì£¼ì˜í•  ì 

```jsx
import { useState, useEffect } from 'react';

const createConnection = ({ serverUrl, roomId }) => {
  return {
    connect() {
      console.log(
        'âœ… Connecting to "' + roomId + '" room at ' + serverUrl + '...',
      );
    },
    disconnect() {
      console.log('âŒ Disconnected from "' + roomId + '" room at ' + serverUrl);
    },
  };
};

const serverUrl = 'https://localhost:1234';

const ChatRoom = ({ roomId }) => {
  const [message, setMessage] = useState('');

  // eslint-disable-next-line react-hooks/exhaustive-deps
  const options = {
    serverUrl: serverUrl,
    roomId: roomId,
  };

  useEffect(() => {
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, [options]);

  return (
    <>
      <h1>Welcome to the {roomId} room!</h1>
      <input value={message} onChange={(e) => setMessage(e.target.value)} />
    </>
  );
};

export default function App() {
  const [roomId, setRoomId] = useState('general');
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select value={roomId} onChange={(e) => setRoomId(e.target.value)}>
          <option value="general">general</option>
          <option value="travel">travel</option>
          <option value="music">music</option>
        </select>
      </label>
      <hr />
      <ChatRoom roomId={roomId} />
    </>
  );
}
```

ê°„ë‹¨í•œ ì±„íŒ…ë£¸ì„ êµ¬í˜„í•œ ì½”ë“œì´ë‹¤.
ë¬´ì—‡ì´ ë¬¸ì œì¼ê¹Œìš”?

ì¸í’‹ì¹¸ì— ì–´ë–¤í•œ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ë§Œí•´ë„ ì¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì„œ connectê°€ ëŠì–´ì¡Œë‹¤ê°€ ì¬ì—°ê²° ëœë‹¤.
ê·¸ ì´ìœ ëŠ” const optionsì™€ ê´€ë ¨ì´ ìˆë‹¤.

ChatRoom ì»´í¬ë„ŒíŠ¸ì˜ ê° ë Œë”ë§ì—ì„œ options ê°ì²´ê°€ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ìƒì„±ëœë‹¤. ReactëŠ” ì´ options ê°ì²´ê°€ ì´ì „ ë Œë”ë§ ì¤‘ì— ìƒì„±ëœ options ê°ì²´ì™€ ë‹¤ë¥¸ ê°ì²´ì„ì„ ê°ì§€í•œë‹¤. ì´ê²ƒì´ optionsì— ì¢…ì†ëœ `Effect`ë¥¼ ë‹¤ì‹œ ë™ê¸°í™”í•˜ê³ , ì±„íŒ…ì´ ì…ë ¥í•˜ëŠ” ëŒ€ë¡œ ë‹¤ì‹œ ì—°ê²°í•˜ëŠ” ì´ìœ ì´ë‹¤.

### ì°¸ê³ 

```jsx
const str1 = 'apple';
const str2 = 'apple';

console.log(str1 === str2); // true

const arr1 = [1, 2];
const arr2 = [1, 2];

console.log(arr1 === arr2); // false
```

ì´ ë¬¸ì œëŠ” ì£¼ë¡œ ê°ì²´ì™€ í•¨ìˆ˜ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤. JavaScriptì—ì„œ ê°ê° ìƒˆë¡œ ìƒì„±ëœ ê°ì²´ì™€ í•¨ìˆ˜ëŠ” ë‹¤ë¥¸ ëª¨ë“  ê°ì²´ì™€ í•¨ìˆ˜ì™€ êµ¬ë³„ë˜ëŠ” ë³„ê°œì˜ ê°ì²´ë¡œ ê°„ì£¼ëœë‹¤. ë‚´ë¶€ ë‚´ìš©ì´ ë™ì¼í•˜ë”ë¼ë„ ì´ë“¤ì´ ì„œë¡œ ë‹¤ë¥¸ ê°ì²´ì„ì„ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤.

> ğŸ’¡ ê°ì²´ì™€ í•¨ìˆ˜ ì¢…ì†ì„±(`dependencies`)ì€ `Effect`ê°€ í•„ìš”í•œ ê²ƒë³´ë‹¤ ë” ìì£¼ ë‹¤ì‹œ ë™ê¸°í™”(ì‹¤í–‰)ë˜ë„ë¡ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

ì´ëŸ° ê²½ìš° ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ê°€?

```jsx
const options = {
  serverUrl: 'https://localhost:1234',
  roomId: 'music'
};

const ChatRoom = () => {
  const [message, setMessage] = useState('');

  useEffect(() => {
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, []);

...
}
```

ì•„ì˜ˆ component ì•ˆì—ì„œ ì—†ì• ë²„ë¦¬ê±°ë‚˜,

```jsx
const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId
    };
    const connection = createConnection(options);
    connection.connect();
    return () => connection.disconnect();
  }, [roomId]);
  // ...
```

ê·¸ë ‡ê²Œ í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°, `useEffect` ì•ˆìœ¼ë¡œ ë„£ì–´ë²„ë¦°ë‹¤.

ê·¸ë ‡ë‹¤ë©´, ë¶€ëª¨ë¡œë¶€í„° ê°ì²´ê°€ ë„˜ì–´ì˜¤ëŠ” ê²½ìš°ì¼ ë• ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?

```jsx
const ChatRoom = ({ options }) => {
  const [message, setMessage] = useState('');

  useEffect(() => {
    const connection = createConnection(options);
    connection.connect();

    return () => connection.disconnect();
  }, [options]);
  // ...
```

ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ì¤‘ì— ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ì‹œ ë Œë”ë§ë  ë•Œë§ˆë‹¤ `Effect`ê°€ ë‹¤ì‹œ ì‹¤í–‰ ë  ìˆ˜ ìˆë‹¤.

ì´ëŸ° ê²½ìš° ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ê°€?

```jsx
function ChatRoom({ options }) {
  const [message, setMessage] = useState('');

  const { roomId, serverUrl } = options;

  useEffect(() => {
    const connection = createConnection({
      roomId: roomId,
      serverUrl: serverUrl
    });
    connection.connect();

    return () => connection.disconnect();
  }, [roomId, serverUrl]); // âœ… All dependencies declared
  // ...
```

êµ¬ì¡°ë¶„í•´í• ë‹¹ì„ í†µí•´ ì¢…ì†ì„±ì„ ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤.

# ë¶ˆí•„ìš”í•œ useEffect ì¤„ì´ê¸°

## ë¶ˆí•„ìš”í•œ object dependencies ì¤„ì´ê¸°

```jsx
useEffect(() => {
  setFormIsValid(emailState.isValid && enteredPassword.trim().length > 6);
}, [emailState, enteredPassword]);
```

ìœ„ì™€ ê°™ì´ í•  ê²½ìš°, í•„ìš” ì—†ëŠ” re-renderingì´ ë°œìƒí•˜ê²Œ ë¨.

ìˆ˜ì •í•œ ê²°ê³¼

```jsx
useEffect(() => {
  setFormIsValid(emailState.isValid && enteredPassword.trim().length > 6);
}, [emailState.isValid, enteredPassword]);
```

```jsx
const { isValid: emailIsValid } = emailState;

useEffect(() => {
  setFormIsValid(
    emailIsValid && enteredPassword.trim().length > 6
  );ğŸ•
}, [emailIsValid, enteredPassword])
```

í•˜ì§€ë§Œ ì´ëŠ” ë˜ ë” ê°œì„ ì´ ê°€ëŠ¥í•˜ë‹¤.

```jsx
const formIsValid = emailState.isValid && passwordIsValid;
```

ë Œë”ë§ ì¤‘ì— ìë™ìœ¼ë¡œ ê³„ì‚°ì´ ëœë‹¤.
ì´ë ‡ê²Œ í–ˆì„ ì‹œ, ì¶”ê°€ë¡œ ë°œìƒí•˜ëŠ” ì—°ì‡„ ì—…ë°ì´íŠ¸ë¥¼ í”¼í•˜ë©°, ì½”ë“œê°€ ë¹¨ë¼ì§€ê³ , ë” ê°„ê²°í•´ì§„ë‹¤.

## ì´ì „ stateê°’ì„ í†µí•˜ì—¬ state ì—…ë°ì´íŠ¸í•˜ê¸°

`useEffect` ë‚´ì—ì„œ prev stateë¥¼ í†µí•´ stateë¥¼ ì—…ë°ì´íŠ¸ í•˜ê³  ì‹¶ì€ ê²½ìš°.
ì•„ë˜ëŠ” ìˆ«ìê°€ 1ì´ˆì— í•˜ë‚˜ì”© ì¦ê°€í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì´ë‹¤.

```jsx
const Counter = () => {
  const [count, setCount] = useState(0);

  useEffect(() => {
    const intervalId = setInterval(() => {
      setCount(count + 1);
    }, 1000);
    return () => clearInterval(intervalId);
  }, [count]);

  return <h1>{count}</h1>;
};
```

í•˜ì§€ë§Œ ì´ëŸ´ ê²½ìš°, countê°€ ë³€í•  ë•Œ ë§ˆë‹¤, `cleanup`ê³¼ `setup` í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê²Œ ëœë‹¤.

ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•´ ì£¼ì–´ì•¼ í•œë‹¤.

```jsx
const Counter = () => {
  const [count, setCount] = useState(0);

  useEffect(() => {
    const intervalId = setInterval(() => {
      setCount(c => c + 1);
    }, 1000);
    return () => clearInterval(intervalId);
  }, []);
```

## Prop ë³€í™”ì— ë”°ë¥¸ state ë³€ê²½

ë¶€ëª¨ë¡œ ë¶€í„° itemsë¥¼ ë°›ê³ , ì´ ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ selection stateë¥¼ nullë¡œ ë°”ê¿”ì£¼ëŠ” ê°„ë‹¨í•œ ë¡œì§.

```jsx
function List({ items }) {
  const [selection, setSelection] = useState(null);

  useEffect(() => {
    setSelection(null);
  }, [items]);
  // ...
}
```

ì–´ë”œ ê°œì„ í•´ì•¼ í•˜ëŠ” ê±¸ê¹Œ?

itemsê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ Listì™€ ê·¸ child componentsê°€ ì˜ˆì „ selectionê°’ìœ¼ë¡œ ì¼ë‹¨ rendering ëœë‹¤. ê·¸ í›„ DOMì— updateë˜ê³ , `useEffect`ê°€ ì‹¤í–‰ì´ ëœë‹¤.

ìì‹ componentì˜ `useEffect`ì™€ ë¶€ëª¨ componentì˜ `useEffect` ì¤‘ ëˆ„ê°€ ë¨¼ì € ì‹¤í–‰ì´ ë ê¹Œ?
ìì‹ ì»´í¬ë„ŒíŠ¸ê°€ ë¨¼ì € ì‹¤í–‰ì´ ëœë‹¤. [ì°¸ê³ ìë£Œ [React] useEffect ì‹¤í–‰ ìˆœì„œ](https://velog.io/@jhsung23/React-useEffect-ì‹¤í–‰-ìˆœì„œ)

ê·¸ë˜ì„œ ì°¨ë¼ë¦¬ ìƒˆ stateë¥¼ ë§Œë“¤ì–´ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

```jsx
function List({ items }) {
  const [selection, setSelection] = useState(null);

  const [prevItems, setPrevItems] = useState(items);
  if (items !== prevItems) {
    setPrevItems(items);
    setSelection(null);
  }
  // ...
}
```

ì´ë ‡ê²Œ í–ˆì„ ë•Œ, setPrevItems(items); ì—ì„œ ìƒíƒœê°€ ë³€í•¨ì„ ì¸ì§€í•˜ê²Œ ë˜ë©´ ê·¸ ìˆœê°„ ë°”ë¡œ Listë¥¼ ì¬ë Œë”ë§ í•œë‹¤.
ì´ì „ ìƒíƒœê°’ì„ í†µí•œ ìì‹ë“¤ì˜ ë Œë”ë§ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.
í•˜ì§€ë§Œ ì´ ë˜í•œ í•œ ë²ˆ ë” ê°œì„ ì´ ê°€ëŠ¥í•˜ë‹¤.
propsë¥¼ ë˜ ë‹¤ë¥¸ stateë¥¼ ì´ìš©í•´ì„œ ê´€ë¦¬í•˜ê²Œ ë˜ë©´ data flowë¥¼ ì´í•´í•˜ê¸° ì–´ë µê²Œ ë§Œë“¤ ë¿ ì•„ë‹ˆë¼, debug í•˜ëŠ” ê²ƒë„ ì–´ë ¤ì›Œì§„ë‹¤.

```jsx
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selectedId, setSelectedId] = useState(null);

  const selection = items.find((item) => item.id === selectedId) ?? null;
  // ...
}
```

useEffect ì‚¬ìš©í•˜ê¸° ì „ì— ê³ ë ¤í•˜ë©´ ì¢‹ì€ ê²ƒ

- rendering ì¤‘ì— calculate í•  ìˆ˜ ìˆëŠ”ì§€
- keyë¥¼ ì´ìš©í•˜ì—¬ ëª¨ë“  stateë¥¼ reset í•  ìˆ˜ ìˆëŠ”ì§€

### keyë¥¼ ì´ìš©í•œë‹¤ëŠ” ê±´ ë­” ì†Œë¦°ê°€ìš”? ğŸ•

userId ë³„ë¡œ ê°ê°ì˜ commentë¥¼ ë‹¬ê¸° ìœ„í•´ commentë¥¼ ì´ˆê¸°í™” í•´ì¤€ë‹¤. ë­ê°€ ë¬¸ì œì¼ê¹Œ?

```jsx
export default function ProfilePage({ userId }) {
  const [comment, setComment] = useState('');

  useEffect(() => {
    setComment('');
  }, [userId]);
  // ...
}
```

ì–´ë–»ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆì„ê¹Œ?

key ì†ì„±ì„ ì´ìš©í•˜ë©´ ëœë‹¤.

```jsx
export default function ProfilePage({ userId }) {
  return <Profile userId={userId} key={userId} />;
}

function Profile({ userId }) {
  // âœ… This and any other state below will reset on key change automatically
  const [comment, setComment] = useState('');
  // ...
}
```

userIdë¥¼ keyë¡œ ì „ë‹¬í•´ì¤€ë‹¤.
ì´ë ‡ê²Œ ë˜ë©´ ReactëŠ” ì„œë¡œ ë‹¤ë¥¸ í‚¤ë¥¼ ê°€ì§„ Profile componentsë¥¼ ë‹¤ë¥¸ componentë¡œ ìƒê°í•˜ë©°, ì–´ë– í•œ stateë„ ê³µìœ í•˜ì§€ ì•Šê²Œ í•œë‹¤.
ê°ê°ì˜ Profile componentëŠ” ê°ê°ì˜ comment stateë¥¼ ê°–ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤. ê·¸ child ê¹Œì§€ë„.
ì£¼ì˜
í‚¤ë¥¼ ì „í˜€ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ReactëŠ” ë°°ì—´ ë‚´ í•­ëª©ì˜ ì¸ë±ìŠ¤ë¥¼ í‚¤ë¡œ ì‚¬ìš©í•œë‹¤.
ê·¸ëŸ¬ë‚˜ í•­ëª©ì´ ì‚½ì…, ì‚­ì œë˜ê±°ë‚˜ ë°°ì—´ì´ ì¬ì •ë ¬ë˜ë©´ í•­ëª©ì„ ë Œë”ë§í•˜ëŠ” ìˆœì„œê°€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë³€ê²½ëœë‹¤. ì¸ë±ìŠ¤ë¥¼ í‚¤ë¡œ ì‚¬ìš©í•˜ë©´ ì¢…ì¢… ë¯¸ë¬˜í•˜ê³  í˜¼ë€ìŠ¤ëŸ¬ìš´ ë²„ê·¸ë¥¼ ìœ ë°œí•œë‹¤.
ë§ˆì°¬ê°€ì§€ë¡œ key={Math.random()}ê³¼ ê°™ì´ í‚¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•  ì‹œ í‚¤ê°€ ë Œë”ë§ ì‚¬ì´ì—ì„œ ì¼ì¹˜í•˜ì§€ ì•Šì•„ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì™€ DOMì´ ë§¤ë²ˆ ë‹¤ì‹œ ìƒì„±ëœë‹¤. ì´ê²ƒì€ ëŠë¦¬ê³ , ëª©ë¡ í•­ëª© ë‚´ë¶€ì˜ ì‚¬ìš©ì ì…ë ¥ì„ ìƒì–´ë²„ë¦°ë‹¤. ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì•ˆì •ì ì¸ IDë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
ì°¸ê³ ë¡œ ì»´í¬ë„ŒíŠ¸ëŠ” í‚¤ë¥¼ í”„ë¡­ìœ¼ë¡œ ë°›ì§€ ì•ŠëŠ”ë‹¤. React ìì²´ì—ì„œë§Œ ì‚¬ìš©ëœë‹¤.
ì»´í¬ë„ŒíŠ¸ê°€ IDê°€ í•„ìš”í•œ ê²½ìš° ë³„ë„ì˜ í”„ë¡­ìœ¼ë¡œ ì „ë‹¬í•œë‹¤:

```jsx
<Profile key={id} userId={id} />
```

## ìºì‹± ë¹„ìš© ì¤„ì´ê¸°

ë¶€ëª¨ë¡œë¶€í„° **todos**ì™€ **filter** ê°’ì„ ë„˜ê²¨ ë°›ì•„, ì´ ê°’ë“¤ì´ ë³€ê²½ë  ë•Œ ë§ˆë‹¤ **getFilteredTodos**(**todos**, **filter**); í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¤ê³  ê²°ê³¼ê°’ì„ ë³€ìˆ˜ì— ì €ì¥í•´ ë Œë”ë§ í•˜ê³  ì‹¶ë‹¤ê³  í•˜ì.

```jsx
const TodoList = ({ todos, filter }) => {
  const [visibleTodos, setVisibleTodos] = useState([]);

  useEffect(() => {
    setVisibleTodos(getFilteredTodos(todos, filter));
  }, [todos, filter]);

  // ...
};
```

ì´ì „ ì˜ˆì œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë¶ˆí•„ìš”í•˜ë©° ë¹„íš¨ìœ¨ì ì´ë‹¤.

```jsx
const TodoList = ({ todos, filter }) => {
  const [newTodo, setNewTodo] = useState('');

  const visibleTodos = getFilteredTodos(todos, filter);
  // ...
};
```

ì´ëŸ° ì‹ìœ¼ë¡œ ë°”ë¡œ êµ¬í˜„í•´ì£¼ë©´ ëœë‹¤. í•˜ì§€ë§Œ ì´ê²Œ ìµœì„ ì¼ê¹Œ?

ë§Œì•½ **getFilteredTodos**ê°€ êµ‰ì¥íˆ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦¬ê³  ë¬´ê±°ìš´ í•¨ìˆ˜ë¼ë©´?
ë Œë”ë§ ë  ë•Œë§ˆë‹¤ í•¨ìˆ˜ ìƒˆë¡œ ì‹¤í–‰ì‹œì¼œì•¼ í•´ì„œ íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§„ë‹¤.
ì´ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ `useMemo`

```jsx
import { useMemo, useState } from 'react';

const TodoList = ({ todos, filter }) => {
  const [newTodo, setNewTodo] = useState('');
  const visibleTodos = useMemo(() => {
    return getFilteredTodos(todos, filter);
  }, [todos, filter]);
  // ...
};
```

**todos**ì™€ **filter**ê°€ ë³€ê²½ë  ë•Œê¹Œì§€ ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

`React`ëŠ” ì´ˆê¸° ë Œë”ë§ ì¤‘ **getFilteredTodos**()ì˜ ë°˜í™˜ ê°’ì„ ê¸°ì–µí•œë‹¤.
ë‹¤ìŒ ë Œë” ì¤‘ì— **todos** ë˜ëŠ” **filter**ê°€ ë‹¤ë¥¸ì§€ í™•ì¸í•œë‹¤.
ì´ì „ê³¼ ë™ì¼í•˜ë‹¤ë©´ `useMemo`ëŠ” ì €ì¥ëœ ë§ˆì§€ë§‰ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
ê·¸ëŸ¬ë‚˜ ë‹¤ë¥´ë‹¤ë©´ `React`ëŠ” ë‚´ë¶€ í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ì €ì¥í•œë‹¤.

í•˜ì§€ë§Œ ì˜ˆì „ ê°’ê³¼ ë¹„êµë¥¼ í•˜ëŠ”ë°ë„ ìƒë‹¹ ë¹„ìš©ì´ ì†Œìš”ê°€ ëœë‹¤.
ë”°ë¼ì„œ ê°œë°œìê°€ ê²½ì¤‘ì„ ì˜ íŒë‹¨í•˜ì—¬, `useMemo`ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

# ê·¸ëŸ¼ calculationì´ expensiveí•œì§€ ì–´ë–»ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆì„ê¹Œ?

ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ì²œ ê°œì˜ ê°ì²´ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ë°˜ë³µí•˜ì§€ ì•ŠëŠ” í•œ, ëŒ€ë¶€ë¶„ ë¹„ì‹¼ ì‘ì—…ì´ ì•„ë‹ ê²ƒì´ë‹¤.
í•˜ì§€ë§Œ ê°ê´€ì ì¸ ìˆ˜ì¹˜ë¡œ í‰ê°€ë¥¼ í•˜ê³  ì‹¶ë‹¤ë©´

```jsx
console.time('filter array');
const visibleTodos = getFilteredTodos(todos, filter);
console.timeEnd('filter array');
```

ìœ„ì™€ ê°™ì´ ì‹œê°„ì„ ì¸¡ì •í•´ë³´ë©´ ëœë‹¤.

ì „ì²´ ë¡œê·¸ëœ ì‹œê°„ì´ ìƒë‹¹í•˜ë©´ (ì˜ˆ: 1ms ì´ìƒ), í•´ë‹¹ ê³„ì‚°ì„ ìºì‹±í•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ì¼ ìˆ˜ ìˆë‹¤.
ì‹¤í—˜ìœ¼ë¡œ useMemoë¡œ ê³„ì‚°ì„ ë˜í•‘í•˜ì—¬ í•´ë‹¹ ìƒí˜¸ ì‘ìš©ì— ëŒ€í•œ ì „ì²´ ë¡œê·¸ëœ ì‹œê°„ì´ ê°ì†Œí–ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### ì£¼ì˜í•  ì 

- useMemoëŠ” ì²« ë²ˆì§¸ ë Œë”ë§ì„ ë¹ ë¥´ê²Œ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤. ì—…ë°ì´íŠ¸ì—ì„œ ë¶ˆí•„ìš”í•œ ì‘ì—…ì„ ê±´ë„ˆ ë›°ë„ë¡ ë„ì™€ì£¼ëŠ” ê²ƒì´ë‹¤.
- ë¨¸ì‹ ì´ ì‚¬ìš©ìë³´ë‹¤ ë¹ ë¥¼ ê²ƒì´ë¼ëŠ” ì ì„ ëª…ì‹¬í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ ì„±ëŠ¥ì„ ì¸ìœ„ì ìœ¼ë¡œ ëŠ¦ì¶”ëŠ” ê²ƒì´ ì¢‹ë‹¤. (ì˜ˆ: Chromeì—ì„œì˜ CPU Throttling ì˜µì…˜).
- ê°œë°œ í™˜ê²½ì—ì„œ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ë©´ ê°€ì¥ ì •í™•í•œ ê²°ê³¼ë¥¼ ì œê³µí•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. (ì˜ˆ: Strict Modeê°€ ì¼œì ¸ ìˆì„ ë•Œ, ì»´í¬ë„ŒíŠ¸ê°€ í•œ ë²ˆì´ ì•„ë‹Œ ë‘ ë²ˆ ë Œë”ë§ëœë‹¤.) ê°€ì¥ ì •í™•í•œ íƒ€ì´ë°ì„ ì–»ìœ¼ë ¤ë©´ í”„ë¡œë•ì…˜ìš©ìœ¼ë¡œ ì•±ì„ ë¹Œë“œí•˜ê³  ì‚¬ìš©ìì™€ ê°™ì€ ì¥ì¹˜ì—ì„œ í…ŒìŠ¤íŠ¸í•´ì•¼ í•œë‹¤.

# ì°¸ê³ ìë£Œ

[useEffect â€“ React](https://react.dev/reference/react/useEffect#reading-the-latest-props-and-state-from-an-effect)
[Synchronizing with Effects â€“ React](https://react.dev/learn/synchronizing-with-effects)
[You Might Not Need an Effect â€“ React](https://react.dev/learn/you-might-not-need-an-effect)
[Removing Effect Dependencies â€“ React](https://react.dev/learn/removing-effect-dependencies)
[Lifecycle of Reactive Effects â€“ React](https://react.dev/learn/lifecycle-of-reactive-effects)
[Separating Events from Effects â€“ React](https://react.dev/learn/separating-events-from-effects)
